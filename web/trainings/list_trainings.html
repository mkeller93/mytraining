<link rel="import" href="add_training.html">
<polymer-element name="list-trainings-control">
<template>
  <div id="main-content">
    <template if="{{success != ''}}">
      <span class="success">{{success}}</span><br><br>
    </template>
    <template if="{{error != ''}}">
      <span class="error">{{error}}</span><br><br>
    </template>
    <template if="{{action == 'delete'}}">
      Really delete training from {{selectedTraining.date}}?
      <button class="red_button" on-click="{{deleteTraining}}">Yes</button>
      <button class="green_button" on-click="{{cancelDelete}}">No</button>
    </template>
   
    <template if="{{action == 'edit'}}">
      <add-training-control on-finish="{{editFinished}}" training="{{selectedTraining}}"></add-training-control>
    </template>
   
    <template if="{{action == 'list'}}">  
      <input type="text" value="{{minDate}}" placeholder="dd.mm.yyyy">
      <input type="text" value="{{maxDate}}" placeholder="dd.mm.yyyy">
      <button class="green_button" on-click="{{search}}">Search</button>
      <button class="orange_button" on-click="{{reset}}">Reset</button>
      
      <br><br>
      
      <template if="{{editable == true}}">
        <table>
          <thead>
            <tr class="table_header">
              <th style="width: 18%;">Date</th>
              <th style="width: 18%;">Trainers</th>
              <th style="width: 18%;">Children</th>
              <th style="width: 18%;">Notes</th>
              <th style="width: 18%;">Action</th>
            </tr>
          </thead>
          <tbody>
            <tr template repeat="{{training in trainings}}">
              <td>{{training.date}}</td>
              <td>
                <template repeat="{{trainer in training.trainers}}">
                  {{trainer}} <br>
                </template>
              </td>
              <td>
                <template repeat="{{children in training.children}}">
                  {{children}} <br>
                </template>
              </td>
              <td>{{training.notes}}</td>
              <td>
                <button class="orange_button" on-click="{{editTraining}}" training-id="{{training.id}}">Edit</button>
                <button class="red_button" on-click="{{showDeleteTraining}}" training-id="{{training.id}}">Delete</button>
              </td>    
            </tr>
          </tbody>
        </table>
      </template>
      <template if="{{editable == false}}">
        <table>
          <thead>
            <tr class="table_header">
              <th style="width: 22%;">Date</th>
              <th style="width: 22%;">Trainers</th>
              <th style="width: 22%;">Children</th>
              <th style="width: 22%;">Notes</th>
            </tr>
          </thead>
          <tbody>
          <tr template repeat="{{training in trainings}}">
              <td>{{training.date}}</td>
              <td>
                <template repeat="{{trainer in training.trainers}}">
                  {{trainer}} <br>
                </template>
              </td>
              <td>
                <template repeat="{{children in training.children}}">
                  {{children}} <br>
                </template>
              </td>
              <td>{{training.notes}}</td>
            </tr>
          </tbody>   
        </table>
      
        <br><br>
      
        <table>
          <thead>
            <tr class="table_header">
              <th>Name</th>
              <th>Total Trainings</th>
            </tr>
          </thead>
          <tbody>
            <tr template repeat="{{trainer in app.data.trainers}}">
              <td>{{trainer}}</td>
              <td>{{totalTrainings[trainer.id]}}</td>
              </tr> 
          </tbody>
        </table>
      </template>      
   </template>
  </div>
</template>
<script type="application/dart" src="list_trainings.dart"></script>
</polymer-element>